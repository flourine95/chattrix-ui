{
  "info": {
    "name": "Chattrix API - Advanced Features",
    "description": "Collection for testing Friend Requests, Message Edit/Delete, Forward, Read Receipts, Pinned Messages, and Conversation Settings",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "1. Friend Requests",
      "item": [
        {
          "name": "1.1 Send Friend Request (User1 -> User2)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER1_TOKEN}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"receiverUserId\": 2,\n  \"nickname\": \"Bạn thân Alice\"\n}"
            },
            "url": {
              "raw": "{{BASE_URL}}/api/friend-requests/send",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "friend-requests", "send"]
            }
          }
        },
        {
          "name": "1.2 Get Received Friend Requests (User2)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER2_TOKEN}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/api/friend-requests/received",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "friend-requests", "received"]
            }
          }
        },
        {
          "name": "1.3 Accept Friend Request (User2)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER2_TOKEN}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/api/friend-requests/{{FRIEND_REQUEST_ID}}/accept",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "friend-requests", "{{FRIEND_REQUEST_ID}}", "accept"]
            }
          }
        },
        {
          "name": "1.4 Send Friend Request (User1 -> User3)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER1_TOKEN}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"receiverUserId\": 3\n}"
            },
            "url": {
              "raw": "{{BASE_URL}}/api/friend-requests/send",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "friend-requests", "send"]
            }
          }
        },
        {
          "name": "1.5 Reject Friend Request (User3)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER3_TOKEN}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/api/friend-requests/{{FRIEND_REQUEST_ID_2}}/reject",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "friend-requests", "{{FRIEND_REQUEST_ID_2}}", "reject"]
            }
          }
        },
        {
          "name": "1.6 Get Sent Friend Requests (User1)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER1_TOKEN}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/api/friend-requests/sent",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "friend-requests", "sent"]
            }
          }
        },
        {
          "name": "1.7 Cancel Friend Request (User1)",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER1_TOKEN}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/api/friend-requests/{{FRIEND_REQUEST_ID_2}}/cancel",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "friend-requests", "{{FRIEND_REQUEST_ID_2}}", "cancel"]
            }
          }
        }
      ]
    },
    {
      "name": "2. Message Edit & Delete",
      "item": [
        {
          "name": "2.1 Edit Message (1st time)",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER1_TOKEN}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"content\": \"Nội dung đã được chỉnh sửa lần 1\"\n}"
            },
            "url": {
              "raw": "{{BASE_URL}}/api/messages/{{MESSAGE_ID}}/edit",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "messages", "{{MESSAGE_ID}}", "edit"]
            }
          }
        },
        {
          "name": "2.2 Edit Message (2nd time)",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER1_TOKEN}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"content\": \"Nội dung đã được chỉnh sửa lần 2\"\n}"
            },
            "url": {
              "raw": "{{BASE_URL}}/api/messages/{{MESSAGE_ID}}/edit",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "messages", "{{MESSAGE_ID}}", "edit"]
            }
          }
        },
        {
          "name": "2.3 Get Edit History",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER1_TOKEN}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/api/messages/{{MESSAGE_ID}}/edit-history",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "messages", "{{MESSAGE_ID}}", "edit-history"]
            }
          }
        },
        {
          "name": "2.4 Delete Message (Soft Delete)",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER1_TOKEN}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/api/messages/{{MESSAGE_ID}}",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "messages", "{{MESSAGE_ID}}"]
            }
          }
        }
      ]
    },
    {
      "name": "3. Message Forward",
      "item": [
        {
          "name": "3.1 Forward Message to Multiple Conversations",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER1_TOKEN}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"messageId\": {{MESSAGE_ID}},\n  \"conversationIds\": [7, 9]\n}"
            },
            "url": {
              "raw": "{{BASE_URL}}/api/messages/forward",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "messages", "forward"]
            }
          }
        }
      ]
    },
    {
      "name": "4. Read Receipts",
      "item": [
        {
          "name": "4.1 Mark Message as Read (User2)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER2_TOKEN}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/api/messages/{{MESSAGE_ID}}/mark-read",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "messages", "{{MESSAGE_ID}}", "mark-read"]
            }
          }
        },
        {
          "name": "4.2 Mark Message as Read (User3)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER3_TOKEN}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/api/messages/{{MESSAGE_ID}}/mark-read",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "messages", "{{MESSAGE_ID}}", "mark-read"]
            }
          }
        },
        {
          "name": "4.3 Get Read Receipts (User1)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER1_TOKEN}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/api/messages/{{MESSAGE_ID}}/read-receipts",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "messages", "{{MESSAGE_ID}}", "read-receipts"]
            }
          }
        },
        {
          "name": "4.4 Mark Conversation as Read (User2)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER2_TOKEN}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/api/conversations/{{CONVERSATION_ID}}/mark-read?lastMessageId=150",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "conversations", "{{CONVERSATION_ID}}", "mark-read"],
              "query": [
                {
                  "key": "lastMessageId",
                  "value": "150"
                }
              ]
            }
          }
        },
        {
          "name": "4.5 Get Total Unread Count (User1)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER1_TOKEN}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/api/unread-count",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "unread-count"]
            }
          }
        }
      ]
    },
    {
      "name": "5. Pinned Messages",
      "item": [
        {
          "name": "5.1 Pin Message 1",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER1_TOKEN}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/api/conversations/{{CONVERSATION_ID}}/pinned-messages/{{MESSAGE_ID_1}}/pin",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "conversations", "{{CONVERSATION_ID}}", "pinned-messages", "{{MESSAGE_ID_1}}", "pin"]
            }
          }
        },
        {
          "name": "5.2 Pin Message 2",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER1_TOKEN}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/api/conversations/{{CONVERSATION_ID}}/pinned-messages/{{MESSAGE_ID_2}}/pin",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "conversations", "{{CONVERSATION_ID}}", "pinned-messages", "{{MESSAGE_ID_2}}", "pin"]
            }
          }
        },
        {
          "name": "5.3 Pin Message 3",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER1_TOKEN}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/api/conversations/{{CONVERSATION_ID}}/pinned-messages/{{MESSAGE_ID_3}}/pin",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "conversations", "{{CONVERSATION_ID}}", "pinned-messages", "{{MESSAGE_ID_3}}", "pin"]
            }
          }
        },
        {
          "name": "5.4 Get Pinned Messages",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER1_TOKEN}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/api/conversations/{{CONVERSATION_ID}}/pinned-messages",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "conversations", "{{CONVERSATION_ID}}", "pinned-messages"]
            }
          }
        },
        {
          "name": "5.5 Unpin Message 2",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER1_TOKEN}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/api/conversations/{{CONVERSATION_ID}}/pinned-messages/{{MESSAGE_ID_2}}/unpin",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "conversations", "{{CONVERSATION_ID}}", "pinned-messages", "{{MESSAGE_ID_2}}", "unpin"]
            }
          }
        },
        {
          "name": "5.6 Try Pin 4th Message (Should Fail)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER1_TOKEN}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/api/conversations/{{CONVERSATION_ID}}/pinned-messages/115/pin",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "conversations", "{{CONVERSATION_ID}}", "pinned-messages", "115", "pin"]
            }
          }
        }
      ]
    },
    {
      "name": "6. Conversation Settings",
      "item": [
        {
          "name": "6.1 Hide Conversation",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER1_TOKEN}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/api/conversations/{{CONVERSATION_ID}}/settings/hide",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "conversations", "{{CONVERSATION_ID}}", "settings", "hide"]
            }
          }
        },
        {
          "name": "6.2 Unhide Conversation",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER1_TOKEN}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/api/conversations/{{CONVERSATION_ID}}/settings/unhide",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "conversations", "{{CONVERSATION_ID}}", "settings", "unhide"]
            }
          }
        },
        {
          "name": "6.3 Archive Conversation",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER1_TOKEN}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/api/conversations/{{CONVERSATION_ID}}/settings/archive",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "conversations", "{{CONVERSATION_ID}}", "settings", "archive"]
            }
          }
        },
        {
          "name": "6.4 Unarchive Conversation",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER1_TOKEN}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/api/conversations/{{CONVERSATION_ID}}/settings/unarchive",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "conversations", "{{CONVERSATION_ID}}", "settings", "unarchive"]
            }
          }
        },
        {
          "name": "6.5 Pin Conversation",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER1_TOKEN}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/api/conversations/{{CONVERSATION_ID}}/settings/pin",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "conversations", "{{CONVERSATION_ID}}", "settings", "pin"]
            }
          }
        },
        {
          "name": "6.6 Unpin Conversation",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER1_TOKEN}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/api/conversations/{{CONVERSATION_ID}}/settings/unpin",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "conversations", "{{CONVERSATION_ID}}", "settings", "unpin"]
            }
          }
        },
        {
          "name": "6.7 Mute Conversation",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER1_TOKEN}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/api/conversations/{{CONVERSATION_ID}}/settings/mute",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "conversations", "{{CONVERSATION_ID}}", "settings", "mute"]
            }
          }
        },
        {
          "name": "6.8 Unmute Conversation",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER1_TOKEN}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/api/conversations/{{CONVERSATION_ID}}/settings/unmute",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "conversations", "{{CONVERSATION_ID}}", "settings", "unmute"]
            }
          }
        },
        {
          "name": "6.9 Get Conversation Settings",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{USER1_TOKEN}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{BASE_URL}}/api/conversations/{{CONVERSATION_ID}}/settings",
              "host": ["{{BASE_URL}}"],
              "path": ["api", "conversations", "{{CONVERSATION_ID}}", "settings"]
            }
          }
        }
      ]
    }
  ]
}

